package com.example.dodo.geologistica;import android.content.Context;import android.os.StrictMode;import android.util.Log;import android.view.View;import android.widget.ListView;import org.ksoap2.SoapEnvelope;import org.ksoap2.serialization.PropertyInfo;import org.ksoap2.serialization.SoapObject;import org.ksoap2.serialization.SoapPrimitive;import org.ksoap2.serialization.SoapSerializationEnvelope;import org.ksoap2.transport.HttpTransportSE;public class Route {    Os os;    public void rotear (){        String SOAP_ACTION = "http://tempuri.org/route";        String METHOD_NAME = "route";        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();        try {            CONSTS.setData();            SoapObject request = new SoapObject(CONSTS.NAMESPACE, METHOD_NAME);            PropertyInfo p1 = new PropertyInfo();            p1.setName("day");            p1.setValue(CONSTS.dataAtualFormatada);            p1.setType(String.class);            request.addProperty(p1);            PropertyInfo p2 = new PropertyInfo();            p2.setName("area");            p2.setValue(CONSTS.tecnico.getArea());            p2.setType(Integer.class);            request.addProperty(p2);            PropertyInfo p3 = new PropertyInfo();            p3.setName("tecnico");            p3.setValue(CONSTS.tecnico.getIdtecnico());            p3.setType(Integer.class);            request.addProperty(p3);            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);            envelope.dotNet = true;            envelope.setOutputSoapObject(request);            HttpTransportSE androidHttpTransport = new HttpTransportSE(CONSTS.URL);            androidHttpTransport.call(SOAP_ACTION, envelope);            SoapPrimitive obj1 = (SoapPrimitive) envelope.getResponse();            if(obj1.toString().equals("true"))                Log.i("Route", "Roteamento OK");        }catch (Exception e) {            Log.i("Route", e.getMessage());        }    }    public void getOsByTech (Context context){        String SOAP_ACTION = "http://tempuri.org/getOsByTech";        String METHOD_NAME = "getOsByTech";        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();        try {            CONSTS.setData();            SoapObject request = new SoapObject(CONSTS.NAMESPACE, METHOD_NAME);            PropertyInfo p1 = new PropertyInfo();            p1.setName("day");            p1.setValue(CONSTS.dataAtualFormatada);            p1.setType(String.class);            request.addProperty(p1);            PropertyInfo p2 = new PropertyInfo();            p2.setName("idTech");            p2.setValue(CONSTS.tecnico.getIdtecnico());            p2.setType(Integer.class);            request.addProperty(p2);            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);            envelope.dotNet = true;            envelope.setOutputSoapObject(request);            HttpTransportSE androidHttpTransport = new HttpTransportSE(CONSTS.URL);            androidHttpTransport.call(SOAP_ACTION, envelope);            SoapObject obj1 = (SoapObject) envelope.getResponse();            GeocoderHelper geocoderHelper = new GeocoderHelper();            for(int i=0; i < obj1.getPropertyCount(); i++)            {                os = new Os();                SoapObject obj2 =(SoapObject) obj1.getProperty(i);                os.setIdOs(Integer.parseInt(obj2.getProperty(0).toString()));                os.setData(obj2.getProperty(3).toString());                os.setData(os.getData().substring(0,10));                os.setHora(obj2.getProperty(4).toString());                if(os.getHora().length() <2)                    os.setHora("0" + os.getHora() + ":00");                else                    os.setHora(os.getHora() + ":00");                os.setEndereco(obj2.getProperty(6).toString()+", " + obj2.getProperty(7).toString());                os.setLatLng(geocoderHelper.getLatLng(context, os.getEndereco()));                CONSTS.listOs.add(os);            }        }catch (Exception e) {        }    }}