package com.example.dodo.geologistica;import android.content.Intent;import android.os.StrictMode;import android.support.v7.app.AppCompatActivity;import android.os.Bundle;import android.view.View;import android.widget.EditText;import android.widget.ListView;import android.widget.TextView;import org.ksoap2.SoapEnvelope;import org.ksoap2.serialization.PropertyInfo;import org.ksoap2.serialization.SoapObject;import org.ksoap2.serialization.SoapPrimitive;import org.ksoap2.serialization.SoapSerializationEnvelope;import org.ksoap2.transport.HttpTransportSE;import java.util.ArrayList;public class ListaOsActivity extends AppCompatActivity {    private static final String SOAP_ACTION = "http://tempuri.org/getOsByDay";    private static final String METHOD_NAME = "getOsByDay";    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();    Os os;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_lista_os);        CONSTS.setData();        try {            SoapObject request = new SoapObject(CONSTS.NAMESPACE, METHOD_NAME);            PropertyInfo p1 = new PropertyInfo();            p1.setName("day");            p1.setValue(CONSTS.dataAtualFormatada);            p1.setType(String.class);            request.addProperty(p1);            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);            envelope.dotNet = true;            envelope.setOutputSoapObject(request);            HttpTransportSE androidHttpTransport = new HttpTransportSE(CONSTS.URL);            androidHttpTransport.call(SOAP_ACTION, envelope);            //Object result = (Object)envelope.getResponse();            //SoapPrimitive result2 = (SoapPrimitive) envelope.getResponse();            //SoapObject result3 = (SoapObject) envelope.getResponse();            //SoapObject soapList = (SoapObject) result3.getProperty("ArrayOfOs");            SoapObject obj1 = (SoapObject) envelope.getResponse();            for(int i=0; i < obj1.getPropertyCount(); i++)            {                os = new Os();                SoapObject obj2 =(SoapObject) obj1.getProperty(i);                os.setIdOs(Integer.parseInt(obj2.getProperty(0).toString()));                os.setData(obj2.getProperty(3).toString());                os.setData(os.getData().substring(0,10));                os.setHora(obj2.getProperty(4).toString());                if(os.getHora().length() <2)                    os.setHora("0" + os.getHora() + ":00");                else                    os.setHora(os.getHora() + ":00");                os.setEndereco(obj2.getProperty(6).toString()+", " + obj2.getProperty(7).toString());                CONSTS.listOs.add(os);            }            ListaAdapterOs listaAdapterOs = new ListaAdapterOs(this, CONSTS.listOs);            ListView listView = (ListView) findViewById(R.id.listView);            listView.setAdapter(listaAdapterOs);        }catch (Exception e) {        }    }    public void rotear (View view){        try {            Route route = new Route();            route.rotear();            route.getOsByTech(this);            Intent intent = new Intent(this, ListaOsTechActivity.class);            startActivity(intent);            setContentView(R.layout.activity_lista_os_tech);        }catch (Exception e) {        }    }}